<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The MLE Ecosystem • compositional.mle</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The MLE Ecosystem">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">compositional.mle</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/theory-and-intuition.html">Theory and Intuition</a></li>
    <li><a class="dropdown-item" href="../articles/case-studies.html">Case Studies</a></li>
    <li><a class="dropdown-item" href="../articles/strategy-design.html">Strategy Design</a></li>
    <li><a class="dropdown-item" href="../articles/mle-ecosystem.html">The MLE Ecosystem</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/queelius/compositional.mle/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The MLE Ecosystem</h1>
                        <h4 data-toc-skip class="author">Alexander
Towell</h4>
            
            <h4 data-toc-skip class="date">2026-02-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/compositional.mle/blob/v1.0.1/vignettes/mle-ecosystem.Rmd" class="external-link"><code>vignettes/mle-ecosystem.Rmd</code></a></small>
      <div class="d-none name"><code>mle-ecosystem.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>compositional.mle</code> is part of an ecosystem of R packages
that share a single design principle from <em>Structure and
Interpretation of Computer Programs</em> (SICP):
<strong>closure</strong>—the result of combining things is itself the
same kind of thing, ready to be combined again.</p>
<p>This principle appears at three levels:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="26%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Level</th>
<th>Package</th>
<th>Closure property</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Solvers</strong></td>
<td><code>compositional.mle</code></td>
<td>Composing solvers yields a solver</td>
</tr>
<tr class="even">
<td><strong>Estimates</strong></td>
<td><code>algebraic.mle</code></td>
<td>Combining MLEs yields an MLE</td>
</tr>
<tr class="odd">
<td><strong>Tests</strong></td>
<td><code>hypothesize</code></td>
<td>Combining hypothesis tests yields a test</td>
</tr>
</tbody>
</table>
<p>This vignette walks through that story. All packages referenced below
are available on CRAN.</p>
</div>
<div class="section level2">
<h2 id="composing-solvers">Composing Solvers<a class="anchor" aria-label="anchor" href="#composing-solvers"></a>
</h2>
<p>The core idea of <code>compositional.mle</code> is that solvers are
first-class functions that compose via operators:</p>
<ul>
<li>
<code>%&gt;&gt;%</code> (sequential chaining) — pipe the result of
one solver into the next</li>
<li>
<code>%|%</code> (parallel racing) — run solvers simultaneously,
keep the best</li>
<li>
<code><a href="../reference/with_restarts.html">with_restarts()</a></code> — retry a solver from multiple starting
points</li>
</ul>
<p>Because each operator returns a solver, you can compose freely:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/compositional.mle" class="external-link">compositional.mle</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, mean <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the log-likelihood (numDeriv handles derivatives by default)</span></span>
<span><span class="va">ll</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>; <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">sigma</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">problem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle_problem.html">mle_problem</a></span><span class="op">(</span>loglike <span class="op">=</span> <span class="va">ll</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Coarse-to-fine: grid search for a starting region, then L-BFGS-B</span></span>
<span><span class="va">strategy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grid_search.html">grid_search</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/lbfgsb.html">lbfgsb</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">1e-4</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">strategy</span><span class="op">(</span><span class="va">problem</span>, theta0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; MLE Solver Result</span></span>
<span><span class="co">#&gt; -----------------</span></span>
<span><span class="co">#&gt; Method:     grid -&gt; lbfgsb</span></span>
<span><span class="co">#&gt; Converged:  TRUE</span></span>
<span><span class="co">#&gt; Iterations: 10</span></span>
<span><span class="co">#&gt; Log-likelihood: -424.84</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Estimate:</span></span>
<span><span class="co">#&gt; [1] 5.0609 1.9498</span></span></code></pre>
<p>You can race different approaches and let the best log-likelihood
win:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">race</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bfgs.html">bfgs</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/race_operator.html">%|%</a></span> <span class="fu"><a href="../reference/nelder_mead.html">nelder_mead</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/race_operator.html">%|%</a></span> <span class="fu"><a href="../reference/gradient_ascent.html">gradient_ascent</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">result_race</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/race.html">race</a></span><span class="op">(</span><span class="va">problem</span>, theta0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Or combine restarts with chaining:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">robust</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/with_restarts.html">with_restarts</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/gradient_ascent.html">gradient_ascent</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="fu"><a href="../reference/bfgs.html">bfgs</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  sampler <span class="op">=</span> <span class="fu"><a href="../reference/uniform_sampler.html">uniform_sampler</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">0.1</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result_robust</span> <span class="op">&lt;-</span> <span class="fu">robust</span><span class="op">(</span><span class="va">problem</span>, theta0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>See <code><a href="../articles/strategy-design.html">vignette("strategy-design")</a></code> for a thorough treatment
of solver composition.</p>
</div>
<div class="section level2">
<h2 id="the-mle-result-object">The <code>mle</code> Result Object<a class="anchor" aria-label="anchor" href="#the-mle-result-object"></a>
</h2>
<p>Every solver returns an <code>mle</code> object (defined by
<code>algebraic.mle</code>). This is the shared currency of the
ecosystem—any package that produces or consumes <code>mle</code> objects
works with every other package.</p>
<p>The <code>mle</code> class provides a uniform interface:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.mle" class="external-link">algebraic.mle</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract estimates and uncertainty</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>       <span class="co"># parameter estimates (theta-hat)</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>           <span class="co"># standard errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>         <span class="co"># variance-covariance matrix</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/loglik_val.html" class="external-link">loglik_val</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>   <span class="co"># log-likelihood at the MLE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>      <span class="co"># 95% confidence intervals</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; params(result)</span></span>
<span><span class="co">#&gt; [1] 5.0609 1.9498</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; se(result)</span></span>
<span><span class="co">#&gt; [1] 0.1379 0.0975</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; vcov(result)</span></span>
<span><span class="co">#&gt;              [,1]         [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.019009 -0.000007</span></span>
<span><span class="co">#&gt; [2,] -0.000007  0.009506</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; loglik_val(result)</span></span>
<span><span class="co">#&gt; [1] -424.84</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; confint(result)</span></span>
<span><span class="co">#&gt;          2.5 %   97.5 %</span></span>
<span><span class="co">#&gt; [1,] 4.7906  5.3312</span></span>
<span><span class="co">#&gt; [2,] 1.7587  2.1410</span></span></code></pre>
<p>The key point: <strong>results from any solver have the same
interface</strong>. Whether you used Newton-Raphson, a grid search, or a
composed pipeline, <code><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params()</a></code>, <code><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se()</a></code>, and
<code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> work the same way.</p>
</div>
<div class="section level2">
<h2 id="combining-independent-mles">Combining Independent MLEs<a class="anchor" aria-label="anchor" href="#combining-independent-mles"></a>
</h2>
<p>Suppose three independent labs each estimate the mean of a
Normal<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\mu, \sigma)</annotation></semantics></math>
population from their own data. Each produces an <code>mle</code>
object. <code>algebraic.mle</code> provides <code><a href="https://queelius.github.io/algebraic.mle/reference/mle_weighted.html" class="external-link">mle_weighted()</a></code>
to combine them via <strong>inverse-variance weighting</strong> using
Fisher information:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Three independent datasets from the same population</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span>,  mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">y3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">75</span>,  mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit each independently</span></span>
<span><span class="va">make_problem</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/mle_problem.html">mle_problem</a></span><span class="op">(</span>loglike <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>; <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">data</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">sigma</span><span class="op">^</span><span class="fl">2</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">solver</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lbfgsb.html">lbfgsb</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">1e-4</span><span class="op">)</span>, upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="fu">make_problem</span><span class="op">(</span><span class="va">y1</span><span class="op">)</span>, theta0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="fu">make_problem</span><span class="op">(</span><span class="va">y2</span><span class="op">)</span>, theta0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="fu">make_problem</span><span class="op">(</span><span class="va">y3</span><span class="op">)</span>, theta0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine: inverse-variance weighting via Fisher information</span></span>
<span><span class="va">combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/mle_weighted.html" class="external-link">mle_weighted</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">fit2</span>, <span class="va">fit3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Individual SEs vs combined</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Source   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lab 1 (n=50)"</span>, <span class="st">"Lab 2 (n=100)"</span>, <span class="st">"Lab 3 (n=75)"</span>, <span class="st">"Combined"</span><span class="op">)</span>,</span>
<span>  Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>               <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  SE       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;            Source Estimate     SE</span></span>
<span><span class="co">#&gt; 1  Lab 1 (n=50)   10.207 0.4243</span></span>
<span><span class="co">#&gt; 2 Lab 2 (n=100)    9.869 0.2998</span></span>
<span><span class="co">#&gt; 3  Lab 3 (n=75)    9.753 0.3464</span></span>
<span><span class="co">#&gt; 4      Combined    9.934 0.1995</span></span></code></pre>
<p>The combined estimate has a smaller standard error than any
individual estimate—this is the power of information pooling. And
because <code><a href="https://queelius.github.io/algebraic.mle/reference/mle_weighted.html" class="external-link">mle_weighted()</a></code> returns an <code>mle</code> object,
you can pass it to any function that accepts MLEs:
<code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code>, <code><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se()</a></code>, further weighting, or
hypothesis testing. <strong>Combining MLEs yields an MLE</strong>
(closure).</p>
</div>
<div class="section level2">
<h2 id="hypothesis-testing-with-hypothesize">Hypothesis Testing with <code>hypothesize</code><a class="anchor" aria-label="anchor" href="#hypothesis-testing-with-hypothesize"></a>
</h2>
<p>The <a href="https://CRAN.R-project.org/package=hypothesize" class="external-link"><code>hypothesize</code></a>
package provides composable hypothesis tests. Like solvers and
estimates, <strong>combining tests yields a test</strong>.</p>
<div class="section level3">
<h3 id="creating-tests-from-mle-results">Creating tests from MLE results<a class="anchor" aria-label="anchor" href="#creating-tests-from-mle-results"></a>
</h3>
<p><code><a href="https://queelius.github.io/hypothesize/reference/wald_test.html" class="external-link">wald_test()</a></code> tests whether a single parameter equals a
hypothesised value. <code><a href="https://queelius.github.io/hypothesize/reference/lrt.html" class="external-link">lrt()</a></code> compares nested models via the
likelihood ratio:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/hypothesize" class="external-link">hypothesize</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Wald test: is mu = 10?</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/hypothesize/reference/wald_test.html" class="external-link">wald_test</a></span><span class="op">(</span>estimate <span class="op">=</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>               se <span class="op">=</span> <span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>               null_value <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">w</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Hypothesis test ( wald_test )</span></span>
<span><span class="co">#&gt; -----------------------------</span></span>
<span><span class="co">#&gt; Test statistic: 0.1094</span></span>
<span><span class="co">#&gt; P-value:       0.7409</span></span>
<span><span class="co">#&gt; Degrees of freedom: 1</span></span>
<span><span class="co">#&gt; Significant at 5% level: FALSE</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Likelihood ratio test: does sigma differ from 3?</span></span>
<span><span class="co"># Compare full model (mu, sigma free) vs restricted (mu free, sigma = 3)</span></span>
<span><span class="va">ll_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/loglik_val.html" class="external-link">loglik_val</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>  <span class="co"># full model log-likelihood</span></span>
<span><span class="va">ll_null</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">y2</span>, mean <span class="op">=</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, sd <span class="op">=</span> <span class="fl">3</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/hypothesize/reference/lrt.html" class="external-link">lrt</a></span><span class="op">(</span>null_loglik <span class="op">=</span> <span class="va">ll_null</span>, alt_loglik <span class="op">=</span> <span class="va">ll_full</span>, dof <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">lr</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Hypothesis test ( likelihood_ratio_test )</span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt; Test statistic: 0.2851</span></span>
<span><span class="co">#&gt; P-value:       0.5934</span></span>
<span><span class="co">#&gt; Degrees of freedom: 1</span></span>
<span><span class="co">#&gt; Significant at 5% level: FALSE</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="combining-independent-tests">Combining independent tests<a class="anchor" aria-label="anchor" href="#combining-independent-tests"></a>
</h3>
<p>When you have independent tests (e.g., each lab tests
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>μ</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">H_0: \mu = 10</annotation></semantics></math>),
<code><a href="https://queelius.github.io/hypothesize/reference/fisher_combine.html" class="external-link">fisher_combine()</a></code> merges them using Fisher’s method:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Each lab tests H0: mu = 10</span></span>
<span><span class="va">w1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/hypothesize/reference/wald_test.html" class="external-link">wald_test</a></span><span class="op">(</span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, null_value <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">w2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/hypothesize/reference/wald_test.html" class="external-link">wald_test</a></span><span class="op">(</span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, null_value <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">w3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/hypothesize/reference/wald_test.html" class="external-link">wald_test</a></span><span class="op">(</span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, null_value <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine independent tests</span></span>
<span><span class="va">combined_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/hypothesize/reference/fisher_combine.html" class="external-link">fisher_combine</a></span><span class="op">(</span><span class="va">w1</span>, <span class="va">w2</span>, <span class="va">w3</span><span class="op">)</span></span>
<span><span class="va">combined_test</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Hypothesis test ( fisher_combined_test )</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; Test statistic: 3.4287</span></span>
<span><span class="co">#&gt; P-value:       0.7534</span></span>
<span><span class="co">#&gt; Degrees of freedom: 6</span></span>
<span><span class="co">#&gt; Significant at 5% level: FALSE</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multiple testing correction</span></span>
<span><span class="va">adjusted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/hypothesize/reference/adjust_pval.html" class="external-link">adjust_pval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">w1</span>, <span class="va">w2</span>, <span class="va">w3</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span></span></code></pre></div>
<p>The combined test is itself a <code>hypothesis_test</code> object—you
can extract <code><a href="https://queelius.github.io/hypothesize/reference/pval.html" class="external-link">pval()</a></code>, check <code><a href="https://queelius.github.io/hypothesize/reference/is_significant_at.html" class="external-link">is_significant_at()</a></code>,
or combine it further. This is the closure property at work.</p>
</div>
<div class="section level3">
<h3 id="the-testing-interface">The testing interface<a class="anchor" aria-label="anchor" href="#the-testing-interface"></a>
</h3>
<p>All <code>hypothesis_test</code> objects share a uniform interface,
mirroring how all <code>mle</code> objects share <code><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params()</a></code> /
<code><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se()</a></code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://queelius.github.io/hypothesize/reference/pval.html" class="external-link">pval</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>                    <span class="co"># extract p-value</span></span>
<span><span class="fu"><a href="https://queelius.github.io/hypothesize/reference/test_stat.html" class="external-link">test_stat</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>               <span class="co"># extract test statistic</span></span>
<span><span class="fu"><a href="https://queelius.github.io/hypothesize/reference/dof.html" class="external-link">dof</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>                     <span class="co"># degrees of freedom</span></span>
<span><span class="fu"><a href="https://queelius.github.io/hypothesize/reference/is_significant_at.html" class="external-link">is_significant_at</a></span><span class="op">(</span><span class="va">w</span>, <span class="fl">0.05</span><span class="op">)</span> <span class="co"># check significance at alpha = 0.05</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>                 <span class="co"># confidence interval (for Wald tests)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="automatic-differentiation">Automatic Differentiation<a class="anchor" aria-label="anchor" href="#automatic-differentiation"></a>
</h2>
<p>Derivatives are pluggable in <code><a href="../reference/mle_problem.html">mle_problem()</a></code>. The solver
never knows (or cares) where they come from:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Strategy 1: numDeriv (default) --- zero effort</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle_problem.html">mle_problem</a></span><span class="op">(</span>loglike <span class="op">=</span> <span class="va">ll</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Strategy 2: hand-coded analytic derivatives</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mle_problem.html">mle_problem</a></span><span class="op">(</span></span>
<span>  loglike <span class="op">=</span> <span class="va">ll</span>,</span>
<span>  score <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>; <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>; <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span> <span class="op">/</span> <span class="va">sigma</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>      <span class="op">-</span><span class="va">n</span> <span class="op">/</span> <span class="va">sigma</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">sigma</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  fisher <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>; <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="va">sigma</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span> <span class="op">*</span> <span class="va">n</span> <span class="op">/</span> <span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Strategy 3: automatic differentiation</span></span>
<span><span class="co"># Any AD package that provides score(f, theta) and hessian(f, theta)</span></span>
<span><span class="co"># can be plugged in here, e.g.:</span></span>
<span><span class="co"># p3 &lt;- mle_problem(</span></span>
<span><span class="co">#   loglike = ll,</span></span>
<span><span class="co">#   score   = function(theta) ad_pkg::score(ll, theta),</span></span>
<span><span class="co">#   fisher  = function(theta) ad_pkg::hessian(ll, theta)</span></span>
<span><span class="co"># )</span></span></code></pre></div>
<p>Each strategy has trade-offs:</p>
<table class="table">
<colgroup>
<col width="28%">
<col width="28%">
<col width="22%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th>Approach</th>
<th>Accuracy</th>
<th>Effort</th>
<th>Speed</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Numerical (<code>numDeriv</code>)</td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>h</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(h^2)</annotation></semantics></math>
truncation error</td>
<td>None (default)</td>
<td>Slow (extra evaluations)</td>
</tr>
<tr class="even">
<td>Hand-coded analytic</td>
<td>Exact</td>
<td>High (error-prone)</td>
<td>Fast</td>
</tr>
<tr class="odd">
<td>Automatic differentiation (AD package)</td>
<td>Exact (machine precision)</td>
<td>Low</td>
<td>Moderate</td>
</tr>
</tbody>
</table>
<p>The general recommendation: <strong>start with the default</strong>
(no explicit derivatives) during model development, then <strong>switch
to an AD package</strong> or hand-coded derivatives when you need
accuracy or performance. For derivative-free problems, use
<code><a href="../reference/nelder_mead.html">nelder_mead()</a></code>.</p>
<table class="table">
<colgroup>
<col width="34%">
<col width="40%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Situation</th>
<th>Recommended</th>
<th>Reason</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Quick prototyping</td>
<td>
<code>numDeriv</code> (default)</td>
<td>Zero effort, just write the log-likelihood</td>
</tr>
<tr class="even">
<td>Production / accuracy-critical</td>
<td>AD package or hand-coded</td>
<td>Exact derivatives</td>
</tr>
<tr class="odd">
<td>Complex models (mixtures, hierarchical)</td>
<td>AD package</td>
<td>Hand-coding is error-prone and tedious</td>
</tr>
<tr class="even">
<td>Non-differentiable objective</td>
<td><code><a href="../reference/nelder_mead.html">nelder_mead()</a></code></td>
<td>Derivative-free simplex method</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="the-ecosystem-at-a-glance">The Ecosystem at a Glance<a class="anchor" aria-label="anchor" href="#the-ecosystem-at-a-glance"></a>
</h2>
<p>The packages form a pipeline: <strong>define</strong> a model,
<strong>solve</strong> for the MLE, <strong>combine</strong> estimates,
and <strong>test</strong> hypotheses—with closure at every level.</p>
<table class="table">
<colgroup>
<col width="37%">
<col width="25%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th>Package</th>
<th>CRAN</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="https://CRAN.R-project.org/package=algebraic.mle" class="external-link"><code>algebraic.mle</code></a></td>
<td>Yes</td>
<td>MLE algebra: <code><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params()</a></code>, <code><a href="https://queelius.github.io/algebraic.mle/reference/se.html" class="external-link">se()</a></code>,
<code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code>, <code><a href="https://queelius.github.io/algebraic.mle/reference/mle_weighted.html" class="external-link">mle_weighted()</a></code>
</td>
</tr>
<tr class="even">
<td><a href="https://CRAN.R-project.org/package=algebraic.dist" class="external-link"><code>algebraic.dist</code></a></td>
<td>Yes</td>
<td>Distribution algebra: convolution, mixture, truncation</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/queelius/compositional.mle" class="external-link"><code>compositional.mle</code></a></td>
<td>—</td>
<td>Solver composition: <code>%&gt;&gt;%</code>, <code>%|%</code>,
<code><a href="../reference/with_restarts.html">with_restarts()</a></code>
</td>
</tr>
<tr class="even">
<td><a href="https://CRAN.R-project.org/package=hypothesize" class="external-link"><code>hypothesize</code></a></td>
<td>Yes</td>
<td>Test composition: <code><a href="https://queelius.github.io/hypothesize/reference/wald_test.html" class="external-link">wald_test()</a></code>, <code><a href="https://queelius.github.io/hypothesize/reference/lrt.html" class="external-link">lrt()</a></code>,
<code><a href="https://queelius.github.io/hypothesize/reference/fisher_combine.html" class="external-link">fisher_combine()</a></code>
</td>
</tr>
<tr class="odd">
<td><a href="https://github.com/queelius/dfr.dist" class="external-link"><code>dfr.dist</code></a></td>
<td>—</td>
<td>Distribution-free reliability methods</td>
</tr>
</tbody>
</table>
<p>The typical workflow:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Define</strong> your model as a log-likelihood and pass it
to <code><a href="../reference/mle_problem.html">mle_problem()</a></code>
</li>
<li>
<strong>Solve</strong> with a composed solver strategy from
<code>compositional.mle</code> — get an <code>mle</code> object</li>
<li>
<strong>Combine</strong> independent estimates with
<code><a href="https://queelius.github.io/algebraic.mle/reference/mle_weighted.html" class="external-link">mle_weighted()</a></code> from <code>algebraic.mle</code> — get a
(better) <code>mle</code> object</li>
<li>
<strong>Test</strong> hypotheses with <code>hypothesize</code> — get
a <code>hypothesis_test</code> object</li>
<li>
<strong>Combine</strong> tests with <code><a href="https://queelius.github.io/hypothesize/reference/fisher_combine.html" class="external-link">fisher_combine()</a></code> —
get a (stronger) <code>hypothesis_test</code> object</li>
</ol>
<p>At every step, the result is the same type as the input. That is the
SICP closure property, and it is what makes the ecosystem
composable.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
